DT表
-
	WITH FAC_WTG(FAC_ALIAS,WTG_ALIAS) AS
	  (SELECT GET_FAC_ALIAS(WTG_ALIAS) FAC_ALIAS,
	    WTG_ALIAS
	  FROM V_WTG
	  WHERE GET_FAC_ALIAS(WTG_ALIAS) IN('CDHS')
	  ),
	  FAC_ST(FAC_ALIAS,SC_STARTTIME_UTC) AS
	  (SELECT FAC_ALIAS,
	    MIN(SC_STARTTIME_UTC)-1
	  FROM
	    (SELECT FAC_WTG.FAC_ALIAS,
	      MIN(SS.SC_STARTTIME_UTC) SC_STARTTIME_UTC
	    FROM TBL_STATE_CHANGE_DOWNTIME SS,
	      FAC_WTG
	    WHERE GENERATION_TIME_UTC>=TO_DATE('20141223 06:00:00','YYYYMMDD HH24:MI:SS')
	    AND SS.WTG_ALIAS          =FAC_WTG.WTG_ALIAS
	    GROUP BY FAC_WTG.FAC_ALIAS
	    UNION ALL
	    SELECT FAC_WTG.FAC_ALIAS,
	      MIN(SS.SC_STARTTIME_UTC) SC_STARTTIME_UTC
	    FROM TBL_STATE_CHANGE_DOWNTIME_LOG SS,
	      FAC_WTG
	    WHERE LOG_TIME_UTC>=TO_DATE('20141223 06:00:00','YYYYMMDD HH24:MI:SS')
	    AND SS.WTG_ALIAS   =FAC_WTG.WTG_ALIAS
	    AND SS.SOURCE_FLAG ='D'
	    GROUP BY FAC_WTG.FAC_ALIAS
	    )
	  GROUP BY FAC_ALIAS
	  )
	SELECT SS.ID,
	  SS.WTG_ALIAS,
	  SS.SC_ID,
	  SS.DT_GROUP_ID,
	  SS.SC_STARTTIME_UTC,
	  SS.SC_STARTTIME_MSEC,
	  SS.SC_WIND_SPEED,
	  SS.SC_ACTIVE_POWER,
	  SS.SC_GENERATOR_SPEED,
	  SS.SC_PITCH_ANGLE,
	  SS.CONFIRM_FLAG,
	  SS.REASON_ID,
	  SS.RESPONSIBILITY_ID,
	  SS.SYSTEM_ID,
	  SS.EQUIPMENT_ID,
	  SS.GENERATION_TIME_UTC,
	  SS.SS_GROUP_ID,
	  CASE
	    WHEN FAC_ST.SC_STARTTIME_UTC<TO_DATE('20141223 06:00:00','YYYYMMDD HH24:MI:SS')-30
	    THEN TO_DATE('20141223 06:00:00','YYYYMMDD HH24:MI:SS')                        -30
	    ELSE FAC_ST.SC_STARTTIME_UTC
	  END STARTTIME_UTC_DEL
	FROM TBL_STATE_CHANGE_DOWNTIME SS,
	  FAC_WTG,
	  FAC_ST
	WHERE SS.WTG_ALIAS       =FAC_WTG.WTG_ALIAS
	AND FAC_WTG.FAC_ALIAS    =FAC_ST.FAC_ALIAS
	AND SS.SC_ID NOT IN (-4,-5)
	AND SS.SC_STARTTIME_UTC >=FAC_ST.SC_STARTTIME_UTC
	AND SS.SC_STARTTIME_UTC >=TO_DATE('20141223 06:00:00','YYYYMMDD HH24:MI:SS')-30
	AND SS.SC_STARTTIME_UTC  <TO_DATE('20141224 06:00:00','YYYYMMDD HH24:MI:SS')
关口表
-
	SELECT TBL_POINTVALUE_STA_10M.DEV_ALIAS, TBL_POINTVALUE_STA_10M.APPRODUCTION, TBL_POINTVALUE_STA_10M.RPPRODUCTION, TBL_POINTVALUE_STA_10M.APCONSUMED, TBL_POINTVALUE_STA_10M.RPCONSUMED, TBL_POINTVALUE_STA_10M.DATATIME_UTC, TBL_POINTVALUE_STA_10M.GENERATION_TIME_UTC FROM TBL_POINTVALUE_STA_10M WHERE TBL_POINTVALUE_STA_10M.GENERATION_TIME_UTC >= TO_DATE('20141223 06:00:00','YYYYMMDD HH24:MI:SS') 
	AND TBL_POINTVALUE_STA_10M.GENERATION_TIME_UTC < TO_DATE('20141224 06:00:00','YYYYMMDD HH24:MI:SS') 
	AND TBL_POINTVALUE_STA_10M.DATATIME_UTC>= TO_DATE('20141223 06:00:00','yyyymmdd hh24:mi:ss')-30 
	AND DEV_ALIAS IN
	(SELECT OTHER_ALIAS
	FROM OTHER_DEVICE
	WHERE OTHERTY                   =5
	AND GET_FAC_ALIAS(OTHER_ALIAS) IN ('CDHS')
	)
首发故障表
-
	WITH FAC_WTG(FAC_ALIAS,WTG_ALIAS) AS
	  (SELECT GET_FAC_ALIAS(WTG_ALIAS) FAC_ALIAS,
	    WTG_ALIAS
	  FROM V_WTG
	  WHERE GET_FAC_ALIAS(WTG_ALIAS) IN('CDHS')
	  ),
	  FAC_ST(FAC_ALIAS,SC_STARTTIME_UTC) AS
	  (SELECT FAC_WTG.FAC_ALIAS,
	    MIN(SS.SC_STARTTIME_UTC)-1 SC_STARTTIME_UTC
	  FROM VIEW_RPT_FIRST_FAULT SS,
	    FAC_WTG
	  WHERE SS.GENERATION_TIME_UTC>=TO_DATE('20141223 06:00:00','YYYYMMDD HH24:MI:SS')
	  AND SS.WTG_ALIAS             =FAC_WTG.WTG_ALIAS
	  GROUP BY FAC_WTG.FAC_ALIAS
	  )
	SELECT SS.WTG_ALIAS,
	  SS.SC_ID,
	  SS.SC_STARTTIME_UTC,
	  SS.SC_STARTTIME_MSEC,
	  SS.SC_ENDTIME_UTC,
	  SS.SC_ENDTIME_MSEC,
	  SS.SC_ACTIVE_POWER,
	  SS.SC_WIND_SPEED,
	  SS.SC_GENERATOR_SPEED,
	  SS.SC_PITCH_ANGLE
	FROM VIEW_RPT_FIRST_FAULT SS,
	  FAC_WTG,
	  FAC_ST
	WHERE SS.WTG_ALIAS       =FAC_WTG.WTG_ALIAS
	AND SS.SC_STARTTIME_UTC >=FAC_ST.SC_STARTTIME_UTC
	AND FAC_WTG.FAC_ALIAS    =FAC_ST.FAC_ALIAS
	AND SS.SC_STARTTIME_UTC  <TO_DATE('20141224 06:00:00','YYYYMMDD HH24:MI:SS')
SS表
-
	WITH FAC_WTG(FAC_ALIAS,WTG_ALIAS) AS
	  (SELECT GET_FAC_ALIAS(WTG_ALIAS) FAC_ALIAS,
	    WTG_ALIAS
	  FROM V_WTG
	  WHERE GET_FAC_ALIAS(WTG_ALIAS) IN('CDHS')
	  ),
	  FAC_ST(FAC_ALIAS,SC_STARTTIME_UTC) AS
	  (SELECT FAC_ALIAS,
	    MIN(SC_STARTTIME_UTC)-1
	  FROM
	    (SELECT FAC_WTG.FAC_ALIAS,
	      MIN(SS.SC_STARTTIME_UTC) SC_STARTTIME_UTC
	    FROM TBL_STATE_CHANGE_STANDARD SS,
	      FAC_WTG
	    WHERE GENERATION_TIME_UTC>=TO_DATE('20141223 06:00:00','YYYYMMDD HH24:MI:SS')
	    AND SS.WTG_ALIAS          =FAC_WTG.WTG_ALIAS
	    AND INSERT_FLAG          <>'V'
	    GROUP BY FAC_WTG.FAC_ALIAS
	    UNION ALL
	    SELECT FAC_WTG.FAC_ALIAS,
	      MIN(SS.SC_STARTTIME_UTC) SC_STARTTIME_UTC
	    FROM TBL_STATE_CHANGE_STANDARD_LOG SS,
	      FAC_WTG
	    WHERE LOG_TIME_UTC>=TO_DATE('20141223 06:00:00','YYYYMMDD HH24:MI:SS')
	    AND SS.WTG_ALIAS   =FAC_WTG.WTG_ALIAS
	    AND SS.SOURCE_FLAG ='D'
	    AND INSERT_FLAG   <>'V'
	    GROUP BY FAC_WTG.FAC_ALIAS
	    )
	  GROUP BY FAC_ALIAS
	  )
	SELECT SS.ID,
	  SS.WTG_ALIAS,
	  SS.SC_ID,
	  SS.SS_GROUP_ID,
	  SS.SC_STARTTIME_UTC,
	  SS.SC_STARTTIME_MSEC,
	  SS.SC_ACTIVE_POWER,
	  SS.SC_WIND_SPEED,
	  SS.SC_GENERATOR_SPEED,
	  SS.SC_PITCH_ANGLE,
	  CASE
	    WHEN FAC_ST.SC_STARTTIME_UTC<TO_DATE('20141223 06:00:00','YYYYMMDD HH24:MI:SS')-30
	    THEN TO_DATE('20141223 06:00:00','YYYYMMDD HH24:MI:SS')                        -30
	    ELSE FAC_ST.SC_STARTTIME_UTC
	  END STARTTIME_UTC_DEL
	FROM TBL_STATE_CHANGE_STANDARD SS,
	  FAC_WTG,
	  FAC_ST
	WHERE SS.WTG_ALIAS       =FAC_WTG.WTG_ALIAS
	AND SS.SC_STARTTIME_UTC >=FAC_ST.SC_STARTTIME_UTC
	AND FAC_WTG.FAC_ALIAS    =FAC_ST.FAC_ALIAS
	AND SS.SC_STARTTIME_UTC >=TO_DATE('20141223 06:00:00','YYYYMMDD HH24:MI:SS')-30
	AND SS.SC_STARTTIME_UTC  <TO_DATE('20141224 06:00:00','YYYYMMDD HH24:MI:SS')
	AND INSERT_FLAG         <>'V'
测点表
-
	 SELECT TBL_POINTVALUE_10M.WTG_ALIAS, TBL_POINTVALUE_10M.APPRODUCTION, TBL_POINTVALUE_10M.RPPRODUCTION, TBL_POINTVALUE_10M.APCONSUMED, TBL_POINTVALUE_10M.RPCONSUMED, TBL_POINTVALUE_10M.PCURVESTSAVE, TBL_POINTVALUE_10M.PCURVESTSMAX, TBL_POINTVALUE_10M.PCURVESTSMIN, TBL_POINTVALUE_10M.PCURVESTSSTD, TBL_POINTVALUE_10M.WINDSPEEDAVE, TBL_POINTVALUE_10M.WINDSPEEDMAX, TBL_POINTVALUE_10M.WINDSPEEDMIN, TBL_POINTVALUE_10M.WINDSPEEDSTD, TBL_POINTVALUE_10M.ACTIVEPWAVE, TBL_POINTVALUE_10M.ACTIVEPWMAX, TBL_POINTVALUE_10M.ACTIVEPWMIN, TBL_POINTVALUE_10M.ACTIVEPWSTD, TBL_POINTVALUE_10M.ACTIVEPWCALAVE, TBL_POINTVALUE_10M.ACTIVEPWCALMAX, TBL_POINTVALUE_10M.ACTIVEPWCALMIN, TBL_POINTVALUE_10M.ACTIVEPWCALSTD, TBL_POINTVALUE_10M.WINDDIRECTIONAVE, TBL_POINTVALUE_10M.WINDDIRECTIONMAX, TBL_POINTVALUE_10M.WINDDIRECTIONMIN, TBL_POINTVALUE_10M.WINDDIRECTIONSTD, TBL_POINTVALUE_10M.WINDVANEDIRECTIONAVE, TBL_POINTVALUE_10M.WINDVANEDIRECTIONMAX, TBL_POINTVALUE_10M.WINDVANEDIRECTIONMIN, TBL_POINTVALUE_10M.WINDVANEDIRECTIONSTD, TBL_POINTVALUE_10M.TEMOUTAVE, TBL_POINTVALUE_10M.TEMOUTMAX, TBL_POINTVALUE_10M.TEMOUTMIN, TBL_POINTVALUE_10M.TEMOUTSTD, TBL_POINTVALUE_10M.ATOMPRESSUREAVE, TBL_POINTVALUE_10M.GENSPDAVE, TBL_POINTVALUE_10M.BLADEPITCHAVE, TBL_POINTVALUE_10M.READWINDSPEEDAVE, TBL_POINTVALUE_10M.READWINDSPEEDMAX, TBL_POINTVALUE_10M.READWINDSPEEDMIN, TBL_POINTVALUE_10M.READWINDSPEEDSTD, TBL_POINTVALUE_10M.TORQUESETPOINTAVE, TBL_POINTVALUE_10M.TORQUEAVE, TBL_POINTVALUE_10M.NACELLEPOSITIONAVE, TBL_POINTVALUE_10M.ROTORSPDAVE, TBL_POINTVALUE_10M.DATATIME_UTC, TBL_POINTVALUE_10M.GENERATION_TIME_UTC FROM TBL_POINTVALUE_10M WHERE TBL_POINTVALUE_10M.GENERATION_TIME_UTC>=TO_DATE('20141223 06:00:00','YYYYMMDD HH24:MI:SS') 
	AND TBL_POINTVALUE_10M.GENERATION_TIME_UTC<TO_DATE('20141224 06:00:00','YYYYMMDD HH24:MI:SS') 
	AND TBL_POINTVALUE_10M.DATATIME_UTC>=TO_DATE('20141223 06:00:00','YYYYMMDD HH24:MI:SS')-30 
	AND WTG_ALIAS IN
	(SELECT WTG_ALIAS
	FROM V_WTG
	WHERE GET_FAC_ALIAS(WTG_ALIAS) IN('CDHS')
	)
